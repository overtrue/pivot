---
title: é¡¹ç›®æ¶æ„
description: æ·±å…¥äº†è§£ Pivot çš„è®¾è®¡ç†å¿µã€ä»£ç ç»„ç»‡å’Œæœ€ä½³å®è·µã€‚
---

# é¡¹ç›®æ¶æ„

Pivot é‡‡ç”¨ç°ä»£åŒ–çš„ç»„ä»¶åº“æ¶æ„ï¼Œæ·±å— [shadcn/ui](https://ui.shadcn.com) å¯å‘ï¼Œä½†ä¸“ä¸º OpenAPI è§„èŒƒä¼˜åŒ–ã€‚æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»é¡¹ç›®çš„è®¾è®¡ç†å¿µã€ç›®å½•ç»“æ„å’Œå¼€å‘è§„èŒƒã€‚

## ğŸ—ï¸ æ€»ä½“æ¶æ„

### è®¾è®¡åŸåˆ™

1. **ç»„ä»¶åˆ†ç¦»**ï¼šæ˜ç¡®åŒºåˆ†å¯åˆ†å‘ç»„ä»¶å’Œç«™ç‚¹ä¸“ç”¨ç»„ä»¶
2. **åŸå­åŒ–è®¾è®¡**ï¼šæ„å»ºå¯ç»„åˆçš„å°ç»„ä»¶ï¼Œçµæ´»ç»„åˆæˆå¤æ‚ç•Œé¢
3. **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript æ”¯æŒï¼Œç¡®ä¿å¼€å‘æ—¶çš„ç±»å‹å®‰å…¨
4. **æŒ‰éœ€å¼•å…¥**ï¼šåªå®‰è£…éœ€è¦çš„ç»„ä»¶ï¼Œå‡å°‘åŒ…ä½“ç§¯
5. **æºç é€æ˜**ï¼šæ‰€æœ‰ç»„ä»¶æºç å¯è§ï¼Œæ–¹ä¾¿å®šåˆ¶å’Œå­¦ä¹ 

### æ¶æ„å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ç”¨æˆ·ç•Œé¢                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Registry ç»„ä»¶åº“               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   pivot/    â”‚      example/        â”‚  â”‚
â”‚  â”‚  (89+ ç»„ä»¶) â”‚    (å¤æ‚ç¤ºä¾‹)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              å·¥å…·å±‚ (lib/)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ hooks/  â”‚ utils/   â”‚    i18n/     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           åŸºç¡€è®¾æ–½ (Next.js)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç›®å½•ç»“æ„è¯¦è§£

### å¯åˆ†å‘ç»„ä»¶ (`registry/`)

è¿™æ˜¯é¡¹ç›®çš„æ ¸å¿ƒï¼ŒåŒ…å«æ‰€æœ‰å¯ä»¥å¯¹å¤–åˆ†å‘çš„ç»„ä»¶å’Œå·¥å…·ï¼š

```
registry/
â”œâ”€â”€ pivot/                    # 89+ åŸå­ç»„ä»¶
â”‚   â”œâ”€â”€ status-code.tsx       # HTTP çŠ¶æ€ç ç»„ä»¶
â”‚   â”œâ”€â”€ method-label.tsx      # HTTP æ–¹æ³•æ ‡ç­¾
â”‚   â”œâ”€â”€ schema-display.tsx    # Schema å±•ç¤ºç»„ä»¶
â”‚   â”œâ”€â”€ try-it-out-panel.tsx  # API æµ‹è¯•é¢æ¿
â”‚   â””â”€â”€ ...                   # æ›´å¤šç»„ä»¶
â”œâ”€â”€ lib/                      # å·¥å…·åº“
â”‚   â”œâ”€â”€ hooks/                # React Hooks
â”‚   â”‚   â”œâ”€â”€ use-openapi.ts    # ä¸»è¦çš„ OpenAPI å¤„ç† Hook
â”‚   â”‚   â”œâ”€â”€ use-operation.ts  # æ“ä½œå¤„ç† Hook
â”‚   â”‚   â””â”€â”€ use-schema.ts     # Schema å¤„ç† Hook
â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ resolve-ref.ts    # å¼•ç”¨è§£æ
â”‚   â”‚   â”œâ”€â”€ generate-example.ts # ç¤ºä¾‹ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ schema-utils.ts   # Schema å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ i18n/                 # å›½é™…åŒ–ç³»ç»Ÿ
â”‚       â”œâ”€â”€ I18nProvider.tsx  # å›½é™…åŒ– Provider
â”‚       â””â”€â”€ locales/          # è¯­è¨€åŒ…
â””â”€â”€ example/                  # å¤æ‚ç¤ºä¾‹ç»„ä»¶
    â””â”€â”€ operation-list-layout-demo.tsx
```

### æ–‡æ¡£ç«™ç‚¹ (`components/`, `app/`, `content/`)

ä¸“ç”¨äºæ–‡æ¡£ç«™ç‚¹çš„ç»„ä»¶å’Œå†…å®¹ï¼š

```
components/                   # ç«™ç‚¹ä¸“ç”¨ç»„ä»¶ï¼ˆä¸åˆ†å‘ï¼‰
â”œâ”€â”€ ui/                      # shadcn/ui åŸºç¡€ç»„ä»¶
â”œâ”€â”€ magicui/                 # ç‰¹æ•ˆç»„ä»¶
â”œâ”€â”€ site-header.tsx          # ç«™ç‚¹å¤´éƒ¨
â”œâ”€â”€ sidebar-nav.tsx          # æ–‡æ¡£ä¾§è¾¹æ 
â””â”€â”€ component-preview.tsx    # ç»„ä»¶é¢„è§ˆ

content/docs/                # MDX æ–‡æ¡£å†…å®¹
â”œâ”€â”€ index.mdx               # ä¸»æ–‡æ¡£é¡µé¢
â”œâ”€â”€ components/             # ç»„ä»¶æ–‡æ¡£
â”œâ”€â”€ installation/           # å®‰è£…æŒ‡å—
â””â”€â”€ templates/              # æ¨¡æ¿æ–‡æ¡£

app/                        # Next.js App Router
â”œâ”€â”€ (docs)/                 # æ–‡æ¡£è·¯ç”±ç»„
â”œâ”€â”€ viewer/                 # OpenAPI æŸ¥çœ‹å™¨
â””â”€â”€ page.tsx               # ä¸»é¡µ
```

## ğŸ”„ ä»£ç å¤ç”¨ç­–ç•¥

### ä¸¥æ ¼çš„åˆ†å±‚åŸåˆ™

Pivot é‡‡ç”¨ä¸¥æ ¼çš„åˆ†å±‚æ¶æ„ï¼Œç¡®ä¿ä»£ç çš„æ¸…æ™°æ€§å’Œå¯ç»´æŠ¤æ€§ï¼š

#### Registry ç»„ä»¶å±‚ (`registry/pivot/`)

**åªèƒ½ä½¿ç”¨**ï¼š

- `../lib/` ä¸‹çš„å·¥å…·å’Œ hooks
- ç¬¬ä¸‰æ–¹åº“
- è‡ªèº«å®šä¹‰çš„ç±»å‹å’Œå‡½æ•°

**ç¦æ­¢ä½¿ç”¨**ï¼š

- `@/hooks/` ä¸‹çš„ç«™ç‚¹ä¸“ç”¨ hooks
- `@/components/` ä¸‹çš„ç«™ç‚¹ç»„ä»¶

```tsx title="registry/pivot/example-component.tsx"
// âœ… æ­£ç¡®çš„å¯¼å…¥
import { useOpenApi } from "../lib/hooks/use-openapi";
import { resolveRef } from "../lib/utils/resolve-ref";
import { cn } from "@/lib/utils";

// âŒ é”™è¯¯çš„å¯¼å…¥
import { useConfig } from "@/hooks/use-config"; // ç«™ç‚¹ä¸“ç”¨ hook
```

#### ç«™ç‚¹ç»„ä»¶å±‚ (`components/`)

**åªèƒ½ä½¿ç”¨**ï¼š

- `@/hooks/` å’Œ `@/lib/` ä¸‹çš„ç«™ç‚¹å·¥å…·
- `@/components/ui/` ä¸‹çš„åŸºç¡€ç»„ä»¶
- Registry ç»„ä»¶ï¼ˆä½œä¸ºä¾èµ–ï¼‰

**ç¦æ­¢ä½¿ç”¨**ï¼š

- ç›´æ¥å¯¼å…¥ `registry/lib/` ä¸‹çš„å·¥å…·

```tsx title="components/example-site-component.tsx"
// âœ… æ­£ç¡®çš„å¯¼å…¥
import { useConfig } from "@/hooks/use-config";
import { StatusCode } from "@/components/pivot/status-code";

// âŒ é”™è¯¯çš„å¯¼å…¥
import { useOpenApi } from "@/lib/hooks/use-openapi";
```

### å·¥å…·å‡½æ•°åˆ†å¸ƒ

#### Registry å·¥å…· (`registry/lib/`)

ä¸“ä¸º OpenAPI å¤„ç†è®¾è®¡ï¼Œå¯åˆ†å‘ï¼š

```tsx
// OpenAPI ä¸“ç”¨å·¥å…·
export function resolveRef(obj, components, category) {
  // å¤„ç† $ref å¼•ç”¨çš„ä¸“ä¸šé€»è¾‘
}

export function generateExample(schema, components, options) {
  // æ ¹æ® Schema ç”Ÿæˆç¤ºä¾‹æ•°æ®
}
```

#### ç«™ç‚¹å·¥å…· (`lib/`, `hooks/`)

ç«™ç‚¹ä¸“ç”¨å·¥å…·ï¼Œä¸åˆ†å‘ï¼š

```tsx
// ç«™ç‚¹é…ç½®
export function useConfig() {
  // ç«™ç‚¹é…ç½®é€»è¾‘
}

// æ–‡æ¡£ç›¸å…³å·¥å…·
export function getTableOfContents(content) {
  // æå–æ–‡æ¡£ç›®å½•
}
```

## ğŸ¨ æ ·å¼å’Œä¸»é¢˜ç³»ç»Ÿ

### Tailwind CSS é…ç½®

åŸºäº Tailwind CSS v4ï¼Œæ”¯æŒæš—è‰²æ¨¡å¼ï¼š

```js title="tailwind.config.js"
module.exports = {
  content: [
    "./pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./components/**/*.{js,ts,jsx,tsx,mdx}",
    "./registry/**/*.{js,ts,jsx,tsx,mdx}",
    "./app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        // çŠ¶æ€ç é¢œè‰²
        status: {
          info: "#3b82f6",
          success: "#10b981",
          redirect: "#f59e0b",
          client: "#f97316",
          server: "#ef4444",
        },
      },
    },
  },
};
```

### ç»„ä»¶å˜ä½“ç³»ç»Ÿ

ä½¿ç”¨ `class-variance-authority` ç®¡ç†ç»„ä»¶å˜ä½“ï¼š

```tsx title="ç¤ºä¾‹ï¼šstatus-code.tsx"
const statusCodeVariants = cva(
  "inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold",
  {
    variants: {
      variant: {
        default: "border-transparent text-primary-foreground",
        outline: "text-foreground",
      },
      size: {
        sm: "px-2 py-0.5 text-xs",
        md: "px-2.5 py-0.5 text-xs",
        lg: "px-3 py-1 text-sm",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "md",
    },
  }
);
```

## ğŸ£ Hooks è®¾è®¡æ¨¡å¼

### useOpenApi - æ ¸å¿ƒ Hook

æä¾› OpenAPI æ•°æ®å¤„ç†çš„å®Œæ•´åŠŸèƒ½ï¼š

```tsx
export function useOpenApi(spec: OpenAPIV3.Document | null) {
  // ç¼“å­˜ç»„ä»¶
  const components = spec?.components;

  // ä¼˜åŒ–çš„å¼•ç”¨è§£æ
  const resolve = useMemo(() => {
    return function resolve<T>(
      obj: T | OpenAPIV3.ReferenceObject,
      category?: string
    ): T | null {
      return resolveRef<T>(obj, components, category);
    };
  }, [components, spec]);

  // è¿”å›å®Œæ•´çš„ API
  return {
    spec,
    components,
    resolve,
    getSchemaType,
    getOperationsByTag,
    // ... æ›´å¤šæ–¹æ³•
  };
}
```

### Hook ç»„åˆæ¨¡å¼

é¼“åŠ± hooks ä¹‹é—´çš„ç»„åˆä½¿ç”¨ï¼š

```tsx
function ApiEndpoint({ spec, path, method }) {
  // ä¸» Hook
  const openApi = useOpenApi(spec);

  // ä¸“ç”¨ Hook
  const operation = useOperation(
    openApi.getOperation(path, method),
    path,
    method
  );

  // æ¨¡å¼ Hook
  const requestSchema = useSchema(
    operation.getRequestBody()?.content?.["application/json"]?.schema,
    openApi.getComponents()
  );

  return <div>{/* ä½¿ç”¨ç»„åˆçš„æ•°æ® */}</div>;
}
```

## ğŸŒ å›½é™…åŒ–æ¶æ„

### åˆ†å¸ƒå¼ç¿»è¯‘ç³»ç»Ÿ

```tsx title="registry/lib/i18n/I18nProvider.tsx"
export const I18nProvider: React.FC<{ children: React.ReactNode }> = ({
  children,
}) => {
  const [locale, setLocale] = useState<"en" | "zh">("en");

  const t = (key: string): string => {
    return locales[locale]?.[key] || key;
  };

  return (
    <I18nContext.Provider value={{ locale, setLocale, t }}>
      {children}
    </I18nContext.Provider>
  );
};
```

### æ—  Provider æ”¯æŒ

Hook è®¾è®¡ä¸ºå³ä½¿æ²¡æœ‰ Provider ä¹Ÿèƒ½å·¥ä½œï¼š

```tsx
export const useI18n = (): I18nContextProps => {
  const context = useContext(I18nContext);

  // æ²¡æœ‰ provider æ—¶çš„é™çº§ç­–ç•¥
  if (!context) {
    return {
      locale: "en",
      setLocale: () =>
        console.warn("useI18n: setLocale called outside of provider"),
      t: createDefaultTranslator("en"),
    };
  }

  return context;
};
```

## ğŸ“¦ Registry ç³»ç»Ÿ

### ç»„ä»¶æ³¨å†Œ

æ¯ä¸ªç»„ä»¶éƒ½åœ¨ `registry.json` ä¸­æ³¨å†Œï¼š

```json
{
  "name": "status-code",
  "type": "registry:ui",
  "dependencies": ["react", "class-variance-authority"],
  "files": [
    {
      "path": "registry/pivot/status-code.tsx",
      "type": "registry:ui"
    }
  ]
}
```

### ä¾èµ–ç®¡ç†

æ”¯æŒç»„ä»¶é—´çš„ä¾èµ–å…³ç³»ï¼š

```json
{
  "name": "parameter-item",
  "registryDependencies": ["status-code", "type-indicator", "required-badge"]
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. ä»£ç åˆ†å‰²

```tsx
// æ‡’åŠ è½½é‡å‹ç»„ä»¶
const TryItOutPanel = dynamic(
  () => import("@/components/pivot/try-it-out-panel"),
  { loading: () => <div>Loading...</div> }
);
```

### 2. è®°å¿†åŒ–ç¼“å­˜

```tsx
// ç¼“å­˜å¤æ‚è®¡ç®—
const operationsByTag = useMemo(() => {
  return openApi.getOperationsByTag();
}, [openApi]);
```

### 3. å¼•ç”¨è§£æä¼˜åŒ–

```tsx
// é¿å…é‡å¤è§£æ
const resolveRef = useMemo(() => {
  const cache = new Map();
  return function resolve(obj, category) {
    const key = `${obj.$ref}-${category}`;
    if (cache.has(key)) return cache.get(key);

    const result = resolveRefImpl(obj, components, category);
    cache.set(key, result);
    return result;
  };
}, [components]);
```

## ğŸ” è´¨é‡ä¿è¯

### TypeScript ä¸¥æ ¼æ¨¡å¼

```json title="tsconfig.json"
{
  "compilerOptions": {
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "exactOptionalPropertyTypes": true
  }
}
```

### ç»„ä»¶ Props éªŒè¯

```tsx
interface StatusCodeProps extends React.HTMLAttributes<HTMLDivElement> {
  code: number;
  variant?: "default" | "outline";
  size?: "sm" | "md" | "lg";
}

// è¿è¡Œæ—¶éªŒè¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
if (process.env.NODE_ENV === "development") {
  if (code < 100 || code > 599) {
    console.warn(`Invalid HTTP status code: ${code}`);
  }
}
```

### é”™è¯¯è¾¹ç•Œ

```tsx
export function ErrorBoundary({ children, fallback }) {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <ErrorBoundaryImpl fallback={fallback}>{children}</ErrorBoundaryImpl>
    </Suspense>
  );
}
```

## ğŸ“š å¼€å‘å·¥ä½œæµ

### 1. ç»„ä»¶å¼€å‘

```bash
# åˆ›å»ºæ–°ç»„ä»¶
touch registry/pivot/new-component.tsx

# æ·»åŠ åˆ° registry
echo '{"name": "new-component", ...}' >> registry.json

# æ„å»º registry
npm run build:registry
```

### 2. æ–‡æ¡£ç¼–å†™

```bash
# åˆ›å»ºç»„ä»¶æ–‡æ¡£
touch content/docs/components/new-component.mdx

# æ·»åŠ ç¤ºä¾‹
touch registry/example/new-component-demo.tsx
```

### 3. æµ‹è¯•éªŒè¯

```bash
# ç±»å‹æ£€æŸ¥
npm run type-check

# æ„å»ºéªŒè¯
npm run build

# ç»„ä»¶æµ‹è¯•
npm run test:components
```

è¿™ä¸ªæ¶æ„ç¡®ä¿äº† Pivot çš„å¯æ‰©å±•æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¼€å‘è€…ä½“éªŒã€‚é€šè¿‡æ¸…æ™°çš„åˆ†å±‚å’Œä¸¥æ ¼çš„è§„èŒƒï¼Œæˆ‘ä»¬èƒ½å¤Ÿæä¾›ä¸€ä¸ªæ—¢å¼ºå¤§åˆæ˜“äºä½¿ç”¨çš„ OpenAPI ç»„ä»¶åº“ã€‚
